# Mini-Quicko (Kaspi Price Analyzer)

![Go](https://img.shields.io/badge/Go-1.19+-00ADD8?logo=go)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-13-336791?logo=postgresql)
![Docker](https://img.shields.io/badge/Docker-3.8-2496ED?logo=docker)

–ú–∏–Ω–∏-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω –Ω–∞ —Ç–æ–≤–∞—Ä—ã Kaspi Marketplace. –°–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ü–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–µ–º–ø–∏–Ω–≥ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è, —Å—Ä–µ–¥–Ω—è—è –∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞.
- **–í—ã—è–≤–ª–µ–Ω–∏–µ –¥–µ–º–ø–∏–Ω–≥–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ —Å –∑–∞–Ω–∏–∂–µ–Ω–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏.
- **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
- **REST API**: –ü—Ä–æ—Å—Ç–æ–π HTTP API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
- **PostgreSQL**: –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.
- **Docker**: –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

–°–µ—Ä–≤–∏—Å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–∞.
- –î–µ–º–ø–∏–Ω–≥—É—é—â–∏—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ (—Ü–µ–Ω–∞ –Ω–∏–∂–µ 90% –æ—Ç —Å—Ä–µ–¥–Ω–µ–π –ø–æ —Å–µ–≥–º–µ–Ω—Ç—É).
- –û–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É —Å —É—á–µ—Ç–æ–º —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞.
- –ò—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend**: Go 1.19+
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL
- **HTTP Router**: Gorilla Mux
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker + Docker Compose

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose.
- Go 1.19+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏).

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Å Docker

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
```bash
git clone <repository-url>
cd Mini-Quicko
```
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å**:
```bash
docker-compose up --build
```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–∞**:
```bash

curl http://localhost:8080/health
```
### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1.**–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
```bash

go mod download
```
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL**:
```bash

docker-compose up db -d
```
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**:
```bash

go run cmd/server/main.go
```
### üì° API Endpoints

1. **Health Check**

        GET /health

        –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞.

    Response:

{
  "status": "healthy"
}

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Kaspi**
```http
    POST /products/save-kaspi-data
```
    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–µ —Å Kaspi Marketplace.

Request Body:
```json
{
  "product_id": "121806358",
  "offers": {
    "offers": [
      {
        "masterSku": "121806358",
        "merchantId": "30358551",
        "merchantName": "Xiaomi Official Store",
        "merchantRating": 4.9,
        "merchantReviewsQuantity": 3588,
        "purchaseCount": 428,
        "price": 179990.0,
        "priceBeforeDiscount": 199990.0,
        "discount": 10,
        "deliveryType": "TO_DOOR",
        "deliveryDuration": "TILL_2_DAYS"
      }
    ],
    "total": 27,
    "offersCount": 27
  }
}
```
Response:
```json
{
  "product_id": "121806358",
  "min_price": 179990,
  "avg_price": 184990,
  "optimal_price": 182000,
  "dumping_sellers": [
    {
      "id": "30358551",
      "name": "Xiaomi Official Store",
      "price": 179990,
      "rating": 4.9,
      "reviews": 3588,
      "purchases": 428,
      "sku": "55421",
      "segment": 3
    }
  ],
  "sellers": [...],
  "total_offers": 27,
  "analysis_time": "2024-01-15T10:30:00Z"
}
```
3. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–∞**
```http
    GET /products/{productId}/analyze
```
    –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.

Response: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ POST /products/save-kaspi-data.

4. **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω**
```http
    GET /products/{productId}/history
```
    –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω.

Response:
```json
[
  {
    "id": 1,
    "product_id": "121806358",
    "seller_id": "30358551",
    "price": 179990,
    "timestamp": "2024-01-15T10:30:00Z"
  }
]
```
5. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–µ**
```http
    GET /products/{productId}/info
```
    –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–¥—É–∫—Ç–µ.

Response:
```json
    {
      "product_id": "121806358",
      "sellers": [...],
      "timestamp": "2024-01-15T10:30:00Z"
    }
```
### üóÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
Mini-Quicko/
‚îú‚îÄ‚îÄ cmd/                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îú‚îÄ‚îÄ config/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ core/               # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ handlers/           # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ repository/         # –†–∞–±–æ—Ç–∞ —Å –ë–î (PostgreSQL)
‚îÇ   ‚îî‚îÄ‚îÄ service/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ docker/                 # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ Dockerfile              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ docker-compose.yml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```
### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|--------------|----------|
| SERVER_PORT | 8080 | –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞ |
| DB_HOST | localhost | –•–æ—Å—Ç PostgreSQL |
| DB_PORT | 5432 | –ü–æ—Ä—Ç PostgreSQL |
| DB_USER | postgres | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î |
| DB_PASSWORD | password | –ü–∞—Ä–æ–ª—å –ë–î |
| DB_NAME | kaspi_analyzer | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |

### üê≥ Docker
–°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
```bash
docker build -t mini-quicko .
```
**–ó–∞–ø—É—Å–∫ —Å Docker Compose**
```bash
docker-compose up -d
```
**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**
```bash
docker-compose logs -f app
```
### üéØ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å Kaspi**
```
curl -X POST http://localhost:8080/products/save-kaspi-data \
  -H "Content-Type: application/json" \
  -d '{
    "product_id": "121806358",
    "offers": {
        "offers": [
            {
                "masterSku": "121806358",
                "merchantId": "30358551",
                "merchantName": "Xiaomi Official Store",
                "merchantRating": 4.9,
                "merchantReviewsQuantity": 3588,
                "purchaseCount": 428,
                "price": 179990.0,
                "priceBeforeDiscount": 199990.0,
                "discount": 10,
                "deliveryType": "TO_DOOR",
                "deliveryDuration": "TILL_2_DAYS"
            }
        ],
        "total": 27,
        "offersCount": 27
    }
}'
```
### –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞
```
curl http://localhost:8080/products/121806358/analyze
```
### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω
```
curl http://localhost:8080/products/121806358/history
```
### üîç –õ–æ–≥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–º–ø–∏–Ω–≥–∞

–ü—Ä–æ–¥–∞–≤–µ—Ü —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–º–ø–∏–Ω–≥—É—é—â–∏–º, –µ—Å–ª–∏:

    –¶–µ–Ω–∞ –Ω–∏–∂–µ 90% –æ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤ –µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–µ.

    –¶–µ–Ω–∞ –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã –≤ —Å–µ–≥–º–µ–Ω—Ç–µ + 5%.

**–†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã**
```bash

optimal_price = (min_price + avg_price) / 2 * rating_multiplier
rating_multiplier = 1.0 + (avg_rating - 4.0) * 0.05
```